<!-- Heroセクション -->
<section class="hero-section position-relative" style="background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url(<%= asset_path 'background_admin.png' %>) center/cover no-repeat; min-height: 400px; display: flex; align-items: center; border-radius: 0 0 32px 32px;">
  <div class="container text-center text-white">
    <h2 class="display-3 fw-bold" style="text-shadow: 0 2px 8px #0008;">
      <i class="fas fa-layer-group me-3"></i>グループ管理
    </h2>
    <p class="fs-5" style="text-shadow: 0 1px 4px #0006;">登録されているグループの一覧と管理を行います</p>
  </div>
</section>

<main class="container my-5" style="max-width: 1200px; min-height: calc(100vh - 900px);">

  <%# --- 新規作成ボタン --- %>
  <div class="text-end mb-4">
    <% if current_admin.company %>
      <%= link_to new_admin_group_path, class: "btn btn-primary btn-lg rounded-pill px-4 shadow" do %>
        <i class="fas fa-plus me-2"></i>新規グループ作成
      <% end %>
    <% else %>
      <button class="btn btn-secondary btn-lg rounded-pill px-4 shadow" disabled>
        <i class="fas fa-plus me-2"></i>新規グループ作成
      </button>
    <% end %>
  </div>

  <%# --- 検索・フィルター --- %>
  <div class="card rounded-4 shadow-sm mb-5 border-0 search-card">
    <div class="card-body">
      <%= form_with url: admin_groups_path, method: :get, local: true do %>
        <div class="row g-4 align-items-end">
          <div class="col-lg-6">
            <label class="form-label fw-semibold">キーワード検索</label>
            <div class="input-group">
              <span class="input-group-text"><i class="fas fa-search"></i></span>
              <%= text_field_tag :keyword, params[:keyword], class: "form-control", placeholder: "グループ名で検索..." %>
            </div>
          </div>
          <div class="col-lg-3">
            <div class="d-flex gap-2">
              <%= submit_tag "検索", class: "btn btn-outline-primary w-50" %>
              <%= link_to "クリア", admin_groups_path, class: "btn btn-outline-secondary w-50" %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <%# --- セクション区切り線 --- %>
  <div class="section-divider"></div>

  <%# --- グループリスト --- %>
  <% @groups.each do |group| %>
    <div class="card mb-4 p-3 shadow-sm fade-in rounded-4">
      <div class="d-md-flex justify-content-between align-items-start gap-4">
        <div class="flex-fill">
          <h5 class="fw-bold text-primary mb-2">
            <div class="d-flex align-items-center">
              <%= link_to group.name, admin_group_path(group), class: "text-decoration-none text-primary" %>
              <% if group.admin_created? %>
                <span class="badge bg-danger ms-2" style="font-size: 0.7rem;">
                  <i class="fas fa-user-shield me-1"></i>管理者作成
                </span>
              <% end %>
            </div>
          </h5>

          <div class="mb-2">
            <span class="badge bg-light status-badge">ID: <%= group.id %></span>
          </div>

          <div class="small text-muted">
            作成者: <%= group.admin_created? ? '管理者' : (group.user&.name || '不明') %> | 作成日: <%= group.created_at.strftime('%Y/%m/%d %H:%M') %>
          </div>
        </div>

        <%# 操作ボタン %>
        <div class="action-buttons mt-3 mt-md-0 d-flex gap-2">
          <%= link_to admin_group_path(group), class: "btn btn-sm btn-outline-primary rounded-pill px-3 py-2 shadow-sm d-flex align-items-center gap-2" do %>
            <i class="fas fa-eye"></i><span>詳細</span>
          <% end %>
          <%= link_to edit_admin_group_path(group), class: "btn btn-sm btn-outline-warning rounded-pill px-3 py-2 shadow-sm d-flex align-items-center gap-2" do %>
            <i class="fas fa-edit"></i><span>編集</span>
          <% end %>
          <%= link_to admin_group_path(group), method: :delete, data: { confirm: '本当に削除しますか？' }, class: "btn btn-sm btn-outline-danger rounded-pill px-3 py-2 shadow-sm d-flex align-items-center gap-2" do %>
            <i class="fas fa-trash"></i><span>削除</span>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <% if @groups.empty? %>
    <div class="text-center py-5">
      <i class="fas fa-layer-group text-muted" style="font-size: 4rem; opacity: 0.3;"></i>
      <% if current_admin.company %>
        <p class="text-muted mt-3">グループがまだ登録されていません。</p>
      <% else %>
        <p class="text-muted mt-3">会社に所属していません。グループ管理機能を使用するには会社に所属する必要があります。</p>
      <% end %>
    </div>
  <% end %>

</main>
