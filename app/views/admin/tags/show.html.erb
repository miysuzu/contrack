<!-- Heroセクション -->
<section class="hero-section position-relative" style="background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url(<%= asset_path 'background_admin.png' %>) center/cover no-repeat; min-height: 400px; display: flex; align-items: center; border-radius: 0 0 32px 32px;">
  <div class="container text-center text-white">
    <h2 class="display-3 fw-bold" style="text-shadow: 0 2px 8px #0008;">
      <i class="fas fa-tag me-3"></i>タグ詳細
    </h2>
    <p class="fs-5" style="text-shadow: 0 1px 4px #0006;">タグの詳細情報と関連契約書を確認できます</p>
  </div>
</section>

<main class="container my-5" style="max-width: 1200px; min-height: calc(100vh - 900px);">

  <div class="row justify-content-center">
    <div class="col-md-10">
      <!-- タグ情報 -->
      <div class="card shadow mb-4" style="border-radius: 16px;">
        <div class="card-body">
          <h5 class="card-title text-primary fw-bold mb-3">
            <i class="fas fa-info-circle me-2"></i>タグ情報
          </h5>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label fw-bold text-muted">タグ名</label>
              <div>
                <span class="badge bg-info text-dark px-4 py-3 fs-5 rounded-pill">
                  <i class="fas fa-tag me-2"></i><%= @tag.name %>
                </span>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label fw-bold text-muted">使用回数</label>
              <div>
                <span class="badge bg-secondary px-4 py-3 fs-5 rounded-pill">
                  <i class="fas fa-link me-2"></i><%= @tag.taggings_count %>件
                </span>
              </div>
            </div>
          </div>
          <% if @tag.created_at %>
            <div class="mt-3">
              <label class="form-label fw-bold text-muted">作成日</label>
              <div>
                <i class="fas fa-calendar-alt text-muted me-2"></i>
                <%= l(@tag.created_at, format: :long) %>
              </div>
            </div>
          <% end %>
        </div>
      </div>

      <!-- 関連契約書 -->
      <div class="card shadow mb-4" style="border-radius: 16px;">
        <div class="card-body">
          <h5 class="card-title text-primary fw-bold mb-3">
            <i class="fas fa-file-contract me-2"></i>このタグが付いている契約書（<%= @contracts.count %>件）
          </h5>
          <% if @contracts.any? %>
            <div class="table-responsive">
              <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                  <tr>
                    <th>ユーザー</th>
                    <th>タイトル</th>
                    <th>ステータス</th>
                    <th>作成日</th>
                    <th class="text-end">操作</th>
                  </tr>
                </thead>
                <tbody>
                  <% @contracts.each do |contract| %>
                    <tr>
                      <td>
                        <i class="fas fa-user text-muted me-2"></i>
                        <%= contract.user&.name || "管理者作成" %>
                      </td>
                      <td>
                        <%= link_to admin_contract_path(contract), class: "fw-bold text-decoration-none" do %>
                          <i class="fas fa-file-alt me-1"></i><%= contract.title %>
                        <% end %>
                      </td>
                      <td>
                        <% if contract.status&.name == "下書き" %>
                          <span class="badge bg-light status-badge"><%= contract.status.name %></span>
                        <% elsif contract.status&.name == "承認待ち" %>
                          <span class="badge bg-warning status-badge"><%= contract.status.name %></span>
                        <% elsif contract.status&.name == "確認中" %>
                          <span class="badge bg-info status-badge"><%= contract.status.name %></span>
                        <% elsif contract.status&.name == "締結済" %>
                          <span class="badge bg-success status-badge"><%= contract.status.name %></span>
                        <% elsif contract.status&.name == "アーカイブ済" %>
                          <span class="badge bg-secondary status-badge"><%= contract.status.name %></span>
                        <% elsif contract.status&.name == "差し戻し" %>
                          <span class="badge bg-danger status-badge"><%= contract.status.name %></span>
                        <% elsif contract.status&.name == "保留" %>
                          <span class="badge bg-warning status-badge"><%= contract.status.name %></span>
                        <% else %>
                          <span class="badge bg-secondary status-badge"><%= contract.status&.name || "未設定" %></span>
                        <% end %>
                      </td>
                      <td>
                        <i class="fas fa-calendar-alt text-muted me-1"></i>
                        <%= l(contract.created_at, format: :short) %>
                      </td>
                      <td class="text-end">
                        <%= link_to admin_contract_path(contract), class: "btn btn-sm btn-outline-primary" do %>
                          <i class="fas fa-eye me-1"></i>詳細
                        <% end %>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          <% else %>
            <div class="text-center py-5 d-flex flex-column align-items-center justify-content-center" style="min-height: 300px;">
              <i class="fas fa-file-contract text-muted mb-3" style="font-size: 3rem;"></i>
              <h5 class="text-muted">このタグが付いている契約書はありません</h5>
              <p class="text-muted mb-0">契約書にこのタグを追加すると、ここに表示されます。</p>
            </div>
          <% end %>
        </div>
      </div>

      <!-- 戻るボタン -->
      <div class="text-center">
        <%= link_to admin_tags_path, class: "btn btn-secondary px-4 me-2" do %>
          <i class="fas fa-arrow-left me-2"></i>タグ一覧に戻る
        <% end %>
        <%= link_to admin_contracts_path, class: "btn btn-primary px-4" do %>
          <i class="fas fa-file-contract me-2"></i>契約書一覧に戻る
        <% end %>
      </div>
    </div>
  </div>

</main>
